{"version":3,"file":"index.js","sources":["src/remove_attrs.js","src/image_set.js","src/picture_set.js","src/remove_class.js","src/index.js","src/check_type.js"],"sourcesContent":["// Taken from https://stackoverflow.com/a/54246501/482751\nconst convertCase = str =>\n  str.replace(/[A-Z]/g, letter => `-${letter.toLowerCase()}`);\n\nexport default (attrs, element) => {\n  attrs.forEach(attr => {\n    const dataAttr = convertCase(attr);\n\n    element.removeAttribute(`data-${dataAttr}`);\n  });\n};\n","import removeAttr from './remove_attrs';\n\nconst setSrcSet = (srcSet, img) => {\n  if (!img.hasAttribute(`data-${srcSet}`)) return;\n\n  const srcset = img.dataset[srcSet];\n  img.setAttribute('srcset', srcset);\n};\n\nexport default ({ src, srcset }, remover, img) => {\n  const Src = img.dataset[src];\n  img.setAttribute('src', Src);\n  img.setAttribute('loading', 'lazy');\n  setSrcSet(srcset, img);\n  removeAttr([src, srcset], img);\n  remover(img);\n};\n","import removeAttr from './remove_attrs';\n\n// const removeAttributes = img => {\n//   img.removeAttribute('data-iesrc');\n//   img.removeAttribute('data-alt');\n// };\n\nconst imgTemplate = ({ src, alt }) =>\n  `<img src=\"${src}\" alt=\"${alt}\" loading=\"lazy\" />`;\n\nconst insertImg = (picture, img) => {\n  picture.insertAdjacentHTML('beforeend', img);\n};\n\nconst getAttrs = ({ src, alt }, picture) => ({\n  alt: picture.dataset[alt],\n  src: picture.dataset[src]\n});\n\nexport default (opts, remover, pic) => {\n  const img = imgTemplate(getAttrs(opts, pic));\n  insertImg(pic, img);\n  const { src, alt } = opts;\n\n  removeAttr([src, alt], pic);\n  remover(pic);\n};\n","export default (css, el) => {\n  el.classList.remove(css);\n};\n","import { checkElements, curry } from '@djforth/utilities';\n\nimport CheckTypes from './check_type';\nimport ImageSet from './image_set';\nimport PictureSet from './picture_set';\nimport RemoveClass from './remove_class';\n\nconst defaultOptions = {\n  selector: 'img.lozad, iframe.lozad, picture.lozad',\n  imgData: {\n    src: 'src',\n    srcset: 'srcset',\n  },\n  removeClass: 'lozad',\n  picData: {\n    src: 'iesrc',\n    alt: 'alt',\n  },\n};\n\nexport default opts => {\n  const { selector, imgData, removeClass, picData } = {\n    ...defaultOptions,\n    ...opts,\n  };\n\n  const elements = [...document.querySelectorAll(selector)];\n\n  if (!checkElements(...elements)) return null;\n\n  const remover = curry(RemoveClass, removeClass);\n\n  const SetImages = curry(ImageSet, imgData, remover);\n  const SetPicture = curry(PictureSet, picData, remover);\n\n  const { iframes, images, pictures } = CheckTypes(elements);\n\n  images.concat(iframes).forEach(SetImages);\n\n  pictures.forEach(SetPicture);\n};\n","export default list =>\n  list.reduce(\n    ({ iframes, images, pictures }, item) => {\n      switch (item.tagName) {\n        case 'PICTURE':\n          pictures.push(item);\n          break;\n        case 'IFRAME':\n          iframes.push(item);\n          break;\n        case 'IMG':\n          images.push(item);\n          break;\n      }\n\n      return { iframes, images, pictures };\n    },\n    {\n      iframes: [],\n      images: [],\n      pictures: [],\n    }\n  );\n"],"names":["attrs","element","forEach","attr","dataAttr","str","replace","letter","toLowerCase","convertCase","removeAttribute","remover","img","src","srcset","Src","dataset","setAttribute","srcSet","hasAttribute","setSrcSet","removeAttr","opts","pic","picture","insertAdjacentHTML","insertImg","alt","imgTemplate","getAttrs","css","el","classList","remove","defaultOptions","selector","imgData","removeClass","picData","elements","document","querySelectorAll","checkElements","curry","RemoveClass","SetImages","ImageSet","SetPicture","PictureSet","list","reduce","item","iframes","images","pictures","tagName","push","CheckTypes","concat"],"mappings":"8wCAIgBA,EAAOC,GACrBD,EAAME,QAAQ,SAAAC,OACNC,EALU,SAAAC,UAClBA,EAAIC,QAAQ,SAAU,SAAAC,oBAAcA,EAAOC,iBAIxBC,CAAYN,GAE7BF,EAAQS,+BAAwBN,mBCCHO,EAASC,OAAxBC,IAAAA,IAAKC,IAAAA,OACfC,EAAMH,EAAII,QAAQH,GACxBD,EAAIK,aAAa,MAAOF,GACxBH,EAAIK,aAAa,UAAW,QAVZ,SAACC,EAAQN,MACpBA,EAAIO,4BAAqBD,SAExBJ,EAASF,EAAII,QAAQE,GAC3BN,EAAIK,aAAa,SAAUH,IAO3BM,CAAUN,EAAQF,GAClBS,EAAW,CAACR,EAAKC,GAASF,GAC1BD,EAAQC,cCIMU,EAAMX,EAASY,IATb,SAACC,EAASZ,GAC1BY,EAAQC,mBAAmB,YAAab,GAUxCc,CAAUH,EAdQ,gBAAGV,IAAAA,IAAKc,IAAAA,8BACbd,oBAAac,yBAYdC,CANG,WAAeJ,OAAZX,IAAAA,IAAKc,IAAAA,UAAoB,CAC3CA,IAAKH,EAAQR,QAAQW,GACrBd,IAAKW,EAAQR,QAAQH,IAIGgB,CAASP,EAAMC,SAE/BV,EAAaS,EAAbT,IAAKc,EAAQL,EAARK,IAEbN,EAAW,CAACR,EAAKc,GAAMJ,GACvBZ,EAAQY,cCzBMO,EAAKC,GACnBA,EAAGC,UAAUC,OAAOH,OCMhBI,EAAiB,CACrBC,SAAU,yCACVC,QAAS,CACPvB,IAAK,MACLC,OAAQ,UAEVuB,YAAa,QACbC,QAAS,CACPzB,IAAK,QACLc,IAAK,wBAIML,cAERY,KACAZ,GAFGa,IAAAA,SAAUC,IAAAA,QAASC,IAAAA,YAAaC,IAAAA,QAKlCC,IAAeC,SAASC,iBAAiBN,QAE1CO,+BAAiBH,IAAW,OAAO,SAElC5B,EAAUgC,QAAMC,EAAaP,GAE7BQ,EAAYF,QAAMG,EAAUV,EAASzB,GACrCoC,EAAaJ,QAAMK,EAAYV,EAAS3B,cCjCjCsC,UACbA,EAAKC,OACH,WAAgCC,OAA7BC,IAAAA,QAASC,IAAAA,OAAQC,IAAAA,gBACVH,EAAKI,aACN,UACHD,EAASE,KAAKL,aAEX,SACHC,EAAQI,KAAKL,aAEV,MACHE,EAAOG,KAAKL,SAIT,CAAEC,QAAAA,EAASC,OAAAA,EAAQC,SAAAA,IAE5B,CACEF,QAAS,GACTC,OAAQ,GACRC,SAAU,KDewBG,CAAWlB,GAAzCa,IAAAA,QAASC,IAAAA,OAAQC,IAAAA,SAEzBD,EAAOK,OAAON,GAASlD,QAAQ2C,GAE/BS,EAASpD,QAAQ6C"}